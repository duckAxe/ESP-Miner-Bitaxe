<ng-template #loading>
    <h4>Loading...</h4>
</ng-template>

<ng-container *ngIf="info$ | async as info; else loading">
    <div class="card">
        <h2>Settings</h2>
        <app-edit></app-edit>
    </div>

    <div class="card flex flex-column gap-1">
        <h5 class="flex m-0">
            <span class="inline-block w-10rem">Current Version:</span>
            v{{info.version}}
        </h5>

        <ng-container *ngIf="latestRelease$ | async as latestRelease">
            @let updateAvailable = isUpdateAvailable(info.version, latestRelease.name);

            <h5 class="flex m-0">
                <span class="inline-block w-10rem">Latest Release:</span>
                <span [ngClass]="{'text-green-500': updateAvailable}">{{latestRelease.name}}</span>
            </h5>

            <p-button
                *ngIf="updateAvailable"
                (click)="otaAutoUpdate(latestRelease.assets)"
                class="mt-3"
                label="Update now">
            </p-button>

            <p *ngIf="!updateAvailable" class="text-500">No updates available</p>
        </ng-container>
    </div>
</ng-container>
